version: "3.7"
networks:
  default:
    internal: true
  gateway:
    external: true
volumes:
  blazegraph-data:
services:
  blazegraph:
    restart: ${RESTART_POLICY}
    image: ${REPOSITORY}/blazegraph:${TAG}
    volumes:
      - blazegraph-data:/data
    networks:
      default:
    labels:
      - traefik.enable=${EXPOSE_BLAZEGRAPH:-false}
      - traefik.http.services.${COMPOSE_PROJECT_NAME}-blazegraph.loadbalancer.server.port=8080
      - traefik.http.routers.${COMPOSE_PROJECT_NAME}-blazegraph_http.service=${COMPOSE_PROJECT_NAME}-blazegraph
      - traefik.http.routers.${COMPOSE_PROJECT_NAME}-blazegraph_http.entrypoints=blazegraph
    deploy:
      resources:
          limits:
            memory: ${BLAZEGRAPH_MEMORY_LIMIT:-5G}
          reservations:
            memory: 2G
